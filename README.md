# Quoicoubeats

## Launch Guide

Welcome to the launch guide for QuoicouBeats Automation. Follow the steps below to set up and successfully launch the project.

### Prerequisites

Ensure that you have Node.js in LTS version installed on your system.

### Installation Steps

1. Install dependencies by running the following command:

```bash
npm i
```

2. Start monitoring changes in the source code with the command:

```bash
npm run langium:watch
```

3. In another terminal, execute the command to watch for changes in source files:

```bash
npm run watch
```

#### Generating Content

Use one of the following scenarios based on your operating system:

#### On Mac or Linux with the launch.sh script

```bash
./launch.sh <path_to_the_scenarios> <chrome|firefox> <keyboard|no-keyboard>
```

Note: The **keyboard** program is only generated if the `KeyboardBinding` entity is present in the script. If there is no configuration for the keyboard, then the HTML file will not be generated. To learn more about the `KeyboardBinding`, please go at [this](#how-to-write-a-scenario) section.

### On Windows with the Launch.bat script

```powershell
Start-Process -FilePath ".\Launch.bat" -ArgumentList "path_to_the_scenarios", "chrome|firefox|no-browser", "keyboard|no-keyboard" .... -Wait
```

### With Visual Studio Code (Linux and Mac only)

1. Open the scenarios file with the .qb extension.
2. Press `Ctrl+Shift+P` or `CMD + Shift+P` to open the command palette.
3. Select `Run Tasks`.
4. Choose between `Run launch QuoicouBeats Script` or `Run launch QuoicouBeats Script for keyboard` based on your needs.

These steps should enable you to successfully launch QuoicouBeats Automation on your machine. If you encounter any issues, make sure you have followed all the steps in the guide and meet the prerequisites.

## Important Note for Firefox Users

If you are using Firefox, please be aware that it is not possible to disable CORS security via command line. The only method is to manually navigate to about:config in the address bar, modify the Mozilla configuration, and set `security.fileuri.strict_origin_policy` to `false`.

After this modification, the MIDI player will be available on both the visualization interface and the interactive keyboard interface.

## Installation and Usage of VS Code Extension

To install the QuoicouBeats Automation extension for Visual Studio Code, follow these steps:

1. Open Visual Studio Code.
2. Navigate to the Extensions view by clicking on the Extensions icon in the Activity Bar on the side of the window or using `Ctrl+Shift+X`.
3. Press the three dots in the upper right corner, then choose "Install from VSIX" or use `Ctrl+Shift+P` and search for "Install VSIX."
4. Go to the `qbeats-ext` folder, and you will find the `qbeats-ext.vsix` file.
5. Once the extension is installed, scenario files with the `.qb` extension will be colorized, and error detection will be enabled.

## The support for user interactive input

### How to write a scenario

To use the support for user interactive input, you just need to add a `KeyboardBinding` configuration to the `.qb` file, outside the `Music` element.

Here is an example of how you must write the no-keyboard configuration :

```
Music "Music" {
  [...]
}

KeyboardBinding {
  Instrument "Drums"
	Bindings {
    Key W -> kd
    Key X -> ch
    Key C -> sd
  }
}
```

In this example, the Drums instrument is configured to play the note _kd_ when _W_ is pressed, _ch_ when _X_ is pressed, and _sd_ when _C_ is pressed.

Currently, two instruments are implemented: **Drums** and **Piano**.

### Using the Keyboard in VS Code:

The keyboard can be launched directly in VS Code through the extension.

1. Generate the interface using the following command:

```bash
./launch.sh <path_to_the_scenarios> no-browser keyboard
```

2. Open the scenario file with the `.qb` extension.
3. Use the keyboard shortcut `Ctrl+Alt+K` or `Cmd+Alt+K` to activate the keyboard.

Now, you can enjoy the enhanced features of QuoicouBeats Automation directly within Visual Studio Code.

### Requirements

In order to be able to listen to the Audio generated by the track (indicated by the `Music` element in the `.qb` file), you need to :

- Have an internet connexion.
- Have the necessary files for the sounds.

#### Necessary files for the sounds

Pour que le programme généré pour le Keyboard (`x_-wk.html`) puisse fonctionner, vous devez avoir dans le même emplacement de fichier le dossier `assets` contenant tous les ficheirs MP3 pour les différents instruments.

To ensure that the generated program for the Keyboard (`x_-wk.html`) can function properly, you must have the `assets` folder, containing all the MP3 files for various instruments, in the same file location.

```
drwxr-xr-x assets
-rw-r--r-- billie-jeans.mid
-rw-r--r-- billie-jeans-wk.html
[...]
```

The `assets` folder is available [here](/generated/assets/).
